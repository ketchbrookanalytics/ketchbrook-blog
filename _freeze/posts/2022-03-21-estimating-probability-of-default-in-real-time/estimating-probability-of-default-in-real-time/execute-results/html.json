{
  "hash": "68637521e30fc5cd3cbe0a54e7b50804",
  "result": {
    "markdown": "---\ntitle: \"Estimating Probability of Default in Real-Time\"\ndescription: \"And the many benefits of a forward-looking approach.\"\nauthor: Michael Thomas\ndate: 2022-03-21\ndraft: false\nimage: preview.PNG\n---\n\n\n\n\nIn our last blog post, we discussed some high-level strategies for [getting more of your data into your model](https://blog.ketchbrookanalytics.com/posts/2022-02-19-making-small-data-bigger/). This week we are going to dive deeper into the benefits of credit risk modeling frameworks that go beyond the \"traditional\" (linear/logistic regression, decision trees, etc.) approaches.\n\n## Making Risk More Dynamic\n\nLet's envision a world where, instead of disparate models that assess probability of default at the time of certain credit events (i.e., one model for origination, another model for renewal, a third for [CECL](https://www.occ.treas.gov/topics/supervision-and-examination/bank-operations/accounting/current-expected-credit-losses/index-current-expected-credit-losses.html), etc.), we have a *single* model that estimates PD in *real-time*.\n\nThis world is not just possible -- it's a framework that Ketchbrook Analytics has spent years developing and building out for our banking clients.\n\nThe **value proposition** for this framework includes *greater flexibility*, *decreased risk* and *improved insights*. The **technical details** of the modeling approach allow any organization to:\n\n* incorporate new information (new repayment data, new economic outlook data, etc.) about a loan to *continuously* update it's predicted probability of default\n\n* look at its portfolio on any given day and understand the current risk for a single loan, a segment of loans, or the entire portfolio\n\n* simulate the impact of a new deal on the portfolio during the underwriting process\n\nFrom a modeling perspective, this means that we want our inputs (predictors) to be the [longitudinal attributes](https://blog.ketchbrookanalytics.com/posts/2022-02-19-making-small-data-bigger#aggregation-is-limiting) about the loan, and the model output to be probability of default.\n\n![](inputs_outputs.PNG)\n\nWith each additional on-time payment, we would expect our model to decrease the associated probability of default. Conversely, if new economic outlook data forecasts worsening industry conditions, the model should update the probability of default to show increasing risk.\n\n## Taking a Forward-Looking Approach\n\nEven more specifically, our model's output should not be a single number -- it should instead be a *curve* that provides us with not just a predicted probability of default, but a probability of default *over the life of the loan*.\n\nTake **Loan #1234**, for example. This five-year term loan just came into our bank today and passed through our model, which returned the following probability of default curve prediction:\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"echarts4r html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-c6de7b26a851145dc579\" style=\"width:100%;height:500px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-c6de7b26a851145dc579\">{\"x\":{\"theme\":\"\",\"tl\":false,\"draw\":true,\"renderer\":\"canvas\",\"events\":[],\"buttons\":[],\"opts\":{\"yAxis\":[{\"show\":true,\"name\":\"\",\"axisLabel\":{\"formatter\":\"function(value, index) {\\n        var fmt = new Intl.NumberFormat('en', {\\\"style\\\":\\\"percent\\\",\\\"minimumFractionDigits\\\":0,\\\"maximumFractionDigits\\\":0,\\\"currency\\\":\\\"USD\\\"});\\n        return fmt.format(value);\\n    }\"}}],\"xAxis\":[{\"data\":[\"2022\",\"2023\",\"2024\",\"2025\",\"2026\"],\"type\":\"category\",\"boundaryGap\":true,\"name\":\"Year\"}],\"legend\":{\"data\":[\"Probability of Default\"],\"show\":false,\"type\":\"plain\"},\"series\":[{\"data\":[{\"value\":[\"2022\",\"0.007503999\"]},{\"value\":[\"2023\",\"0.019517418\"]},{\"value\":[\"2024\",\"0.065092755\"]},{\"value\":[\"2025\",\"0.088780812\"]},{\"value\":[\"2026\",\"0.160179988\"]}],\"yAxisIndex\":0,\"xAxisIndex\":0,\"name\":\"Probability of Default\",\"type\":\"line\",\"coordinateSystem\":\"cartesian2d\",\"areaStyle\":[],\"smooth\":true}],\"title\":[{\"text\":\"Loan #1234 (At Origination)\",\"subtext\":\"Estimated Probability of Default over Lifetime (5-Year Term)\"}],\"tooltip\":{\"trigger\":\"axis\",\"formatter\":\"function(params, ticket, callback) {\\n        var fmt = new Intl.NumberFormat('en', {\\\"style\\\":\\\"percent\\\",\\\"minimumFractionDigits\\\":1,\\\"maximumFractionDigits\\\":1,\\\"currency\\\":\\\"USD\\\"});\\n        var res = params[0].value[0];\\n        for (i = 0; i < params.length; i++) {\\n            res += '<br />' +\\n                   params[i].marker + ' ' +\\n                   params[i].seriesName + ': ' +\\n                   fmt.format(parseFloat(params[i].value[1]));\\n        }\\n        return res;\\n    }\",\"axisPointer\":{\"label\":\"function(params, ticket, callback) {\\n        var fmt = new Intl.NumberFormat('en', {\\\"style\\\":\\\"percent\\\",\\\"minimumFractionDigits\\\":1,\\\"maximumFractionDigits\\\":1,\\\"currency\\\":\\\"USD\\\"});\\n        var res = params[0].value[0];\\n        for (i = 0; i < params.length; i++) {\\n            res += '<br />' +\\n                   params[i].marker + ' ' +\\n                   params[i].seriesName + ': ' +\\n                   fmt.format(parseFloat(params[i].value[1]));\\n        }\\n        return res;\\n    }\"}}},\"dispose\":true},\"evals\":[\"opts.yAxis.0.axisLabel.formatter\",\"opts.tooltip.formatter\",\"opts.tooltip.axisPointer.label\"],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n*[Tip: You can hover over the chart above -- it's interactive! Each point represents the probability of the loan defaulting at or before that date. If we want to know the probability of a specific loan (including a new loan, a renewal, or a group of existing loans in a portfolio) defaulting today, we can easily get this by looking at the left-most point on the PD curve(s). If we want to know the probability of a loan ever defaulting during its life, we can easily get this by looking at the right-most point.]*\n\nOur model estimates that **Loan #1234** has a 0.8% probability of defaulting sometime prior to the end of this year (2022), a 2.0% probability of defaulting between now and the end of 2023, and so on, with a 16.0% probability of defaulting during its life.\n\nFast-forward two years later, and **Loan #1234** has not yet defaulted, with three years remaining on its five-year term. We have new information about this loan's performance that we did not have at origination (e.g., repayment history), as well as updated information (e.g., industry outlook). Running it through our model again, the curve has likely changed:\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"echarts4r html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-526384d0667b76f3da59\" style=\"width:100%;height:500px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-526384d0667b76f3da59\">{\"x\":{\"theme\":\"\",\"tl\":false,\"draw\":true,\"renderer\":\"canvas\",\"events\":[],\"buttons\":[],\"opts\":{\"yAxis\":[{\"show\":true,\"name\":\"\",\"axisLabel\":{\"formatter\":\"function(value, index) {\\n        var fmt = new Intl.NumberFormat('en', {\\\"style\\\":\\\"percent\\\",\\\"minimumFractionDigits\\\":0,\\\"maximumFractionDigits\\\":0,\\\"currency\\\":\\\"USD\\\"});\\n        return fmt.format(value);\\n    }\"}}],\"xAxis\":[{\"data\":[\"2024\",\"2025\",\"2026\"],\"type\":\"category\",\"boundaryGap\":true,\"name\":\"Year\"}],\"legend\":{\"data\":[\"Probability of Default\"],\"show\":false,\"type\":\"plain\"},\"series\":[{\"data\":[{\"value\":[\"2024\",\"0.04595530\"]},{\"value\":[\"2025\",\"0.04787393\"]},{\"value\":[\"2026\",\"0.07164692\"]}],\"yAxisIndex\":0,\"xAxisIndex\":0,\"name\":\"Probability of Default\",\"type\":\"line\",\"coordinateSystem\":\"cartesian2d\",\"areaStyle\":[],\"smooth\":true}],\"title\":[{\"text\":\"Loan #1234 (Two Years Later)\",\"subtext\":\"Estimated Probability of Default over Lifetime (5-Year Term)\"}],\"tooltip\":{\"trigger\":\"axis\",\"formatter\":\"function(params, ticket, callback) {\\n        var fmt = new Intl.NumberFormat('en', {\\\"style\\\":\\\"percent\\\",\\\"minimumFractionDigits\\\":1,\\\"maximumFractionDigits\\\":1,\\\"currency\\\":\\\"USD\\\"});\\n        var res = params[0].value[0];\\n        for (i = 0; i < params.length; i++) {\\n            res += '<br />' +\\n                   params[i].marker + ' ' +\\n                   params[i].seriesName + ': ' +\\n                   fmt.format(parseFloat(params[i].value[1]));\\n        }\\n        return res;\\n    }\",\"axisPointer\":{\"label\":\"function(params, ticket, callback) {\\n        var fmt = new Intl.NumberFormat('en', {\\\"style\\\":\\\"percent\\\",\\\"minimumFractionDigits\\\":1,\\\"maximumFractionDigits\\\":1,\\\"currency\\\":\\\"USD\\\"});\\n        var res = params[0].value[0];\\n        for (i = 0; i < params.length; i++) {\\n            res += '<br />' +\\n                   params[i].marker + ' ' +\\n                   params[i].seriesName + ': ' +\\n                   fmt.format(parseFloat(params[i].value[1]));\\n        }\\n        return res;\\n    }\"}}},\"dispose\":true},\"evals\":[\"opts.yAxis.0.axisLabel.formatter\",\"opts.tooltip.formatter\",\"opts.tooltip.axisPointer.label\"],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nIn the case of **Loan #1234**, it looks like it has been performing pretty well, since the *updated* probability of defaulting before term is down from 16.0% to 7.2%.\n\n### One Model to Rule Them All\n\nIn our toy example, we used an annual frequency along the x-axis of our charts. In practice, this frequency would be much more granular -- at least monthly, and hopefully daily. Remember, the time granularity of our model's output is tied directly to the frequency of the input data. In other words, if we get new repayment & economic outlook data each *month*, then (1) our model will output a predicted probability of default for each *month* into the future, and (2) that prediction curve can be updated each *month*.\n\n> From a practical perspective, having a modeling framework that provides probability of default estimates in **real-time** (including origination) that updates dynamically as we get new information allows us to quickly build automated loan decisioning, scorecard lending, CECL, and stress testing models along the **same** probability of default framework.\n\n## Interested in Learning More?\n\nGet in touch with us today at [info@ketchbrookanalytics.com](mailto:info@ketchbrookanalytics.com)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\r\n<script src=\"../../site_libs/echarts4r-4.8.0/echarts-en.min.js\"></script>\r\n<script src=\"../../site_libs/echarts4r-4.8.0/ecStat.min.js\"></script>\r\n<script src=\"../../site_libs/echarts4r-4.8.0/dataTool.min.js\"></script>\r\n<script src=\"../../site_libs/echarts4r-binding-0.4.4/echarts4r.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}