---
title: "Towards Building a Dynamic Credit Risk Framework"
description: |
  Models and systems, systems and models
author:
  - name: Michael Thomas
    url: {https://www.linkedin.com/in/michaeljthomas2/}
date: 2022-03-13
output:
  distill::distill_article:
    self_contained: false
draft: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(echarts4r)
```

Last week discussed some high-level strategies for [getting more of your data into your model](https://blog.ketchbrookanalytics.com/posts/2022-02-19-making-small-data-bigger/). This week we are going to dive deeper into the benefits of credit risk modeling frameworks that go beyond the "traditional" (linear/logistic regression, decision trees, etc.) approaches. 

The central problem we are trying to solve is multi-faceted:

![](pd_conflict_diagram.png)

To further complicate matters, regulatory requirements such as [CECL](https://www.occ.treas.gov/topics/supervision-and-examination/bank-operations/accounting/current-expected-credit-losses/index-current-expected-credit-losses.html) may lead to modeling probability of default in an entirely different way. 

## Making Risk More Dynamic

Let's envision a world where, instead of disparate models that assess probability of default at the time of certain credit events (e.g., origination, renewal, etc.), we have a *single* model that estimates PD in *real-time*.

This world is not just possible -- it's a framework that Ketchbrook Analytics has spent years developing, and building out for our banking clients.

### What Do We Have to Gain?

The value proposition for this framework includes **greater flexibility**, **decreased risk** and **improved insights**. The technical details of the modeling approach allow any organization to:

* incorporate new information (new repayment data, new economic outlook data, etc.) about a loan to *continuously* update it's predicted probability of default

* look at our portfolio on any given day and understand the current risk for a single loan, a segment of loans, or the entire portfolio

* simulate the impact of a new deal on our portfolio during the underwriting process

From a modeling perspective, this means that we want our inputs (predictors) to be the [longitudinal attributes](https://blog.ketchbrookanalytics.com/posts/2022-02-19-making-small-data-bigger#aggregation-is-limiting) about the loan, and the model output to be probability of default.

![](inputs_outputs.PNG)

Even more specific, our model *output* should not be a single number -- it should instead be a *curve* that provides us with not just a predicted probability of default, but a probability of default *over the life of the loan*.

Take **Loan #1234**, for example. This five-year term loan just came into our bank today and passed through our model, which returned the following probability of default curve prediction:

```{r, fig.alt="Interactive Chart Showing Probability of Default over Time for a Single Loan"}
htmltools::includeHTML("new_loan_plot.html")
```

*[Tip: You can hover over the chart above -- it's interactive!]*

Fast-forward two years later, and **Loan #1234** has not yet defaulted, with three years remaining on its five-year term. We have new information about this loan that we did not have at origination (e.g., repayment history), as well as updated information (e.g., industry outlook). Running it through our model again, the curve has likely changed:

```{r, fig.alt="Interactive Chart Showing Probability of Default over Time for a Single Loan, Two Years Later"}
htmltools::includeHTML("existing_loan_plot.html")
```

We would hope to see a loan with strong repayment history and an improving industry outlook to show less risk across the PD curve. Conversely, we would hope that a loan with multiple past due events and worsening industry outlook would have an updated PD curve that expressed greater risk (i.e., greater probability of default over the remaining life of the loan).

### What Can We Do With This?

If we want to know the probability of a specific loan (including a new loan, a renewal, or a group of existing loans in a portfolio) defaulting *today*, we can easily get this by looking at the left-most point on the PD curves above.

If we want to know the probability of a loan *ever* defaulting during its life, we can easily get this by looking at the right-most point on the curve.

Using this approach, 

> From a practical perspective, having a modeling framework that provides probability of default estimates at *any time* (including origination) that updated dynamically as we get new information allows us to quickly build automated loan decisioning, scorecard lending, CECL, and stress testing models.





This means that 
* not updating the risk as new information comes in about a loan
  + we should be seeing on a day-to-day basis as we get new transaction information about a loan and new economic data related to that loans industry that the outlook for that loan is changing
  + this is okay! This is why we diversify our credit portfolio -- on a day-to-day basis, some loans (and segments of the portfolio) will experience increases in their probability of default, and some loans will experience decreases. We simply need to make sure we have a mechanism for viewing this
* typically have completely separate methods for assessing PD of a loan during its life, even though most scorecard/auto-decision models are also conceptually based on probability of default
  + this makes it very difficult to look at the portfolio on any given day to *dynamically* assess current risk for a single loan, a segment of loans, or the entire portfolio
* it also doesn't provide us with any tools to assess the impact of a new loan into our overall portfolio (i.e., what is the impact of adding this new loan on our entire portfolio)

THESE THINGS SHOULD ALL BE WITHIN THE SAME FRAMEWORK!

This is something that the insurance industry has done very well. As a new policy is underwritten, most insurers typically have either a mechanism for plugging that policy into their overall risk system to view in real-time the policy affects the portfolio's risk -- one segment of the portfolio may be positively or negatively correlated with another segment, based upon micro- or macro-economic risk, geo-spatial risk (i.e., we wouldn't want our entire portfolio to be underwritten in one city), etc.

## Interested in Learning More?

Get in touch with us today at [info@ketchbrookanalytics.com](mailto:info@ketchbrookanalytics.com)
